---
title: Ex 2.6
author: Sarah Cooper
date: '2020-02-24'
slug: ex-2-6
categories: [exercise 2.6]
tags: [chapter 2]
output: html_document
---



<p>#Choose your own prior for the parameters of the beta distribution. You can do this by sketching it here: <a href="https://jhubiostatistics.shinyapps.io/drawyourprior" class="uri">https://jhubiostatistics.shinyapps.io/drawyourprior</a>. Once you have set up a prior, re-analyse the data from Section 2.9.2, where we saw Y = 40 successes out of n = 300 trials. Compare your posterior distribution to the one we obtained in that section using a QQ-plot.</p>
<p>#In 2.9.2, we looked at finding the marginal distribution of Y. In this example they used an alpha of 50, a beta of 350, and an n of 300 to generate a y for a random sample of 10000 thetas
rtheta = rbeta(100000, 50, 350)
y = vapply(rtheta, function(th) {
rbinom(1, prob = th, size = 300)
}, numeric(1))
hist(y, breaks = 50, col = “orange”, main = &quot;“, xlab =”&quot;)</p>
<p>#After running the above, for each of these thetas, we then generate a random sample of Y as observed in this histogram (with orange bars).</p>
<p>#Our next step is to use this information to generate a posterior distribution of theta at a fixed Y value. In this example they used Y=40</p>
<p>thetaPostEmp = rtheta[ y == 40 ]
hist(thetaPostEmp, breaks = 40, col = “chartreuse4”, main = &quot;“,
probability = TRUE, xlab = expression(”posterior“~theta))
densPostTheory = dbeta(thetas, 90, 610)
lines(thetas, densPostTheory, type=”l&quot;, lwd = 3)</p>
<p>#After running the above, for each of these thetas, we generated simulated values for the posterior distribution of theta at Y=40 as observed in this histogram (with green bars).</p>
<div id="section" class="section level1">
<h1></h1>
<p>mean(thetaPostEmp)
#0.1286394
dtheta = thetas[2]-thetas[1]
sum(thetas * densPostTheory * dtheta)
#0.1285714
#</p>
</div>
<div id="section-1" class="section level1">
<h1></h1>
<p>qqplot(thetaPostMC, thetaPostEmp, type = “l”, asp = 1)
abline(a = 0, b = 1, col = “blue”)
#</p>
<p>#**Now back to exercise 2.6. After sketching a plot, I chose the parameters to set up a prior: alpha = 2.47 and beta = 8.5. Using the equation from above I replaced their alpha and beta with mine.</p>
<p>thetas = seq(0, 1, by = 0.001)
plot(thetas, loglikelihood(thetas), xlab = expression(theta),
ylab = expression(paste(“log f(”, theta, &quot; | y)“)),type =”l&quot;)</p>
<p>rtheta = rbeta(1000000, 2.47, 8.5)
y = vapply(rtheta, function(th) {
rbinom(1, prob = th, size = 300)
}, numeric(1))
hist(y, breaks = 50, col = “orange”, main = &quot;“, xlab =”&quot;)</p>
<p>rbinom(length(rtheta), rtheta, size = 300)</p>
<p>thetaPostEmp = rtheta[ y == 40 ]
hist(thetaPostEmp, breaks = 40, col = “chartreuse4”, main = &quot;“,
probability = TRUE, xlab = expression(”posterior“~theta), ylim=c(0,40))
densPostTheory = dbeta(thetas, 42.47, 268.5)
lines(thetas, densPostTheory, type=”l&quot;, lwd = 3)</p>
<p>mean(thetaPostMC)
#0.1365705</p>
<p>dtheta = thetas[2]-thetas[1]
sum(thetas * densPostTheory * dtheta)
#0.1365727</p>
<p>thetaPostMC = rbeta(n = 1e6, 42.47, 268.5)
mean(thetaPostMC)
#0.1365902</p>
<p>qqplot(thetaPostMC, thetaPostEmp, type = “l”, asp = 1)
abline(a = 0, b = 1, col = “blue”)</p>
<p>densPost2 = dbeta(thetas, 42.47, 268.5)
mcPost2 = rbeta(1e6, 42.47, 268.5)</p>
<p>sum(thetas * densPost2 * dtheta) # mean, by numeric integration
# [1] 0.1365727
mean(mcPost2) # mean, by MC
# [1] 0.1365778
thetas[which.max(densPost2)] # MAP estimate
# [1] 0.134</p>
<p>quantile(mcPost2, c(0.025, 0.975))
# 2.5% 97.5%
#0.1006757 0.1768317</p>
</div>
